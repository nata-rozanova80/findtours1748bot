# Hot Tours Parser Telegram Bot  
Версия: 1.0.0  

---

## Репозиторий и структура проекта

- [ ] Репозиторий создан (GitHub/GitLab/локальный)  
- [ ] В корне есть минимальная структура проекта:  
  - [ ] `bot.py` – Telegram‑бот, обработчики `/start` и `/promo`  
  - [ ] `parser.py` – парсинг сайтов туроператоров  
  - [ ] `db.py` – работа с SQLite (инициализация, CRUD)  
  - [ ] `config.py` – загрузка настроек и переменных окружения  
  - [ ] `utils.py` – вспомогательные функции (опционально)  
  - [ ] `requirements.txt` – список зависимостей  
  - [ ] `README.md` – описание проекта и инструкции  
  - [ ] `CHECKLIST.md` – текущий чеклист  
- [ ] Добавлен `.gitignore` (исключены `.env`, `venv/`, `*.db`, `*.log`, `__pycache__/` и т.п.)  

---

## Требования и цели проекта

- [ ] Описана цель проекта: бот показывает до 10 актуальных «горящих туров» по `/promo`  
- [ ] Определены целевые сайты (1–3 источника):  
  - [ ] Coral Travel – горящие предложения  
  - [ ] ANEX Tour – акции/спецпредложения  
  - [ ] Sunmar – акции/горящие туры  
- [ ] Зафиксированы минимальные требования для зачёта:  
  - [ ] Парсинг хотя бы 1 сайта  
  - [ ] SQLite хранилище `offers.db`  
  - [ ] Команды `/start` и `/promo`  
  - [ ] Выдача до 10 предложений из БД  

---

## Окружение и зависимости (Local Dev)

- [ ] Установлен Python (3.10+ рекомендуется)  
- [ ] Создано виртуальное окружение (`venv`)  
- [ ] Установлены зависимости из `requirements.txt`:  
  - [ ] `python-telegram-bot==20.8`  
  - [ ] `requests`  
  - [ ] `beautifulsoup4`  
  - [ ] `python-dotenv`  
  - [ ] `sqlite3` (встроен в стандартную библиотеку)  
- [ ] Проект успешно запускается локально без ошибок импортов  

---

## Конфигурация и секреты

- [ ] Создан файл `.env` (не в репозитории)  
- [ ] В `.env` указаны:  
  - [ ] `TELEGRAM_BOT_TOKEN=...` – токен бота от BotFather  
  - [ ] (опционально) параметры прокси/сетевые настройки  
- [ ] В `config.py` реализована загрузка переменных окружения  
- [ ] Проверено, что при отсутствии `.env` бот корректно сообщает об ошибке (или завершается с понятным логом)  

---

## База данных SQLite

- [ ] Определена схема таблицы `offers` с полями:  
  - [ ] `id INTEGER PRIMARY KEY AUTOINCREMENT`  
  - [ ] `title TEXT NOT NULL`  
  - [ ] `link TEXT NOT NULL`  
  - [ ] `source TEXT`  
  - [ ] `created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP`  
  - [ ] `UNIQUE(title, link)` для защиты от дублей  
- [ ] Реализована функция `init_db()`  
- [ ] Реализована функция `save_offers(offers: list[dict])`  
- [ ] Реализована функция `get_last_offers(limit: int = 10)`  
- [ ] Проверено, что дубли по `title+link` не создают ошибки (используется `INSERT OR IGNORE` или аналог)  
- [ ] Файл `offers.db` добавлен в `.gitignore`  

---

## Парсинг сайтов туроператоров

- [ ] В `parser.py` реализованы функции:  
  - [ ] `get_offers_from_coral()`  
  - [ ] `get_offers_from_anex()`  
  - [ ] `get_offers_from_sunmar()`  
- [ ] Для каждого сайта:  
  - [ ] Определён URL страницы с акциями/горящими турами  
  - [ ] Проанализирован HTML и выбраны устойчивые CSS‑селекторы  
  - [ ] Извлекаются `title` и `link` (при наличии – также дополнительные поля)  
- [ ] При сетевых ошибках (timeout, 4xx/5xx) парсер:  
  - [ ] Логирует ошибку  
  - [ ] Возвращает пустой список (не падает)  
- [ ] При изменении верстки (0 найденных блоков):  
  - [ ] Логируется предупредительное сообщение  
- [ ] Все функции парсинга возвращают список словарей вида:  
  - [ ] `{"title": ..., "link": ..., "source": ...}`  

---

## TITLE – Логика Telegram‑бота

- [ ] В `bot.py` настроено подключение к Telegram через `python-telegram-bot`  
- [ ] Реализована команда `/start`:  
  - [ ] Приветственное сообщение  
  - [ ] Краткое описание возможностей бота  
  - [ ] Подсказка по `/promo`  
- [ ] Реализована команда `/promo`:  
  - [ ] Получение до 10 последних записей через `get_last_offers()`  
  - [ ] Формирование читаемого текста: нумерованный список, `title` + `link`  
  - [ ] Обработка случая, когда предложений нет (понятное сообщение пользователю)  
- [ ] Бот корректно обрабатывает исключения (не падает на одной ошибке сообщения)  

---

## TITLE – Интеграция парсера и бота

- [ ] Реализован сценарий обновления базы:  
  - [ ] Отдельный скрипт `parser_runner.py` ИЛИ  
  - [ ] Фоновая задача внутри `bot.py` (APScheduler)  
- [ ] При обновлении:  
  - [ ] Вызываются функции парсинга всех подключённых сайтов  
  - [ ] Результаты передаются в `save_offers()`  
- [ ] Проверено, что `/promo` показывает обновлённые данные после очередного запуска парсера  

---

## TITLE – Логирование и отладка

- [ ] Настроен модуль `logging` (минимум уровень `INFO`)  
- [ ] Логи пишутся в:  
  - [ ] Консоль  
  - [ ] (опционально) файл `bot.log`  
- [ ] Логируются:  
  - [ ] Старт/остановка бота  
  - [ ] Запуск и результат парсинга (кол-во найденных предложений)  
  - [ ] Ошибки HTTP и парсинга  
  - [ ] Ошибки работы с БД  
  - [ ] Ошибки Telegram API  

---

## TITLE – Документация и UX

- [ ] `README.md` содержит:  
  - [ ] Описание проекта и его цели  
  - [ ] Технологический стек  
  - [ ] Архитектуру проекта  
  - [ ] Схему БД  
  - [ ] Инструкции по установке и запуску  
  - [ ] Описание команд бота  
  - [ ] Формат сдачи проекта (для преподавателя)  
- [ ] `CHECKLIST.md` добавлен в репозиторий  
- [ ] Оформлена краткая инструкция для проверки (можно прямо в README)  

---

## TITLE – Production / Деплой (опционально)

- [ ] Определена целевая среда (VPS, локальный сервер, Docker и т.п.)  
- [ ] Установлена целевая ОС (например, Ubuntu 22.04 LTS)  
- [ ] Установлен Python нужной версии  
- [ ] Создан пользователь/директория для проекта (например, `/opt/hot-tours-bot`)  
- [ ] Настроено виртуальное окружение и установлены зависимости  
- [ ] Скопированы файлы проекта (без `.env`, создаётся отдельно)  
- [ ] Создан и настроен `systemd`‑unit (если используется systemd)  
- [ ] Проверена автозагрузка бота после перезагрузки сервера  

---

## TITLE – Финальная проверка перед сдачей

- [ ] Бот запускается без ошибок  
- [ ] `/start` работает и возвращает корректное приветствие  
- [ ] `/promo` возвращает список из 1–10 предложений (при наличии данных в БД)  
- [ ] При пустой БД бот корректно сообщает об этом  
- [ ] Обновление предложений успешно выполняется (вручную или по расписанию)  
- [ ] README и CHECKLIST актуальны и соответствуют реализации  
- [ ] Секреты (`.env`, токены, база) не попали в репозиторий  
